{"ast":null,"code":"import _regeneratorRuntime from\"E:/Tesis_gigi/instrumento/ins_tesis/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"E:/Tesis_gigi/instrumento/ins_tesis/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useContext}from'react';import{DataExcel}from'../../context/DataExcel';import*as FileSaver from\"file-saver\";import*as XLSX from\"xlsx\";import styles from\"./Piepag.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Piepag(){var _useContext=useContext(DataExcel),dataExcel=_useContext.dataExcel;var fileType='xlsx';var exportToExcel=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var ws,wb,excelBuffer,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:ws=XLSX.utils.json_to_sheet(dataExcel);wb={Sheets:{data:ws},SheetNames:['data']};excelBuffer=XLSX.write(wb,{bookType:'xlsx',type:'array'});data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,\"myfile\"+\".xlsx\");case 5:case\"end\":return _context.stop();}},_callee);}));return function exportToExcel(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:styles.piepag,children:/*#__PURE__*/_jsxs(\"button\",{onClick:exportToExcel,children:[/*#__PURE__*/_jsx(\"img\",{src:\"./imagenes/excel.jpg\",alt:\"Imagen excel\"}),\"DESCARGAR RESULTADOS\"]})});}export default Piepag;","map":{"version":3,"names":["React","useContext","DataExcel","FileSaver","XLSX","styles","jsx","_jsx","jsxs","_jsxs","Piepag","_useContext","dataExcel","fileType","exportToExcel","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","ws","wb","excelBuffer","data","wrap","_callee$","_context","prev","next","utils","json_to_sheet","Sheets","SheetNames","write","bookType","type","Blob","saveAs","stop","apply","arguments","className","piepag","children","onClick","src","alt"],"sources":["E:/Tesis_gigi/instrumento/ins_tesis/src/components/PiePag/Piepag.jsx"],"sourcesContent":["import React, { useContext } from 'react'\r\nimport { DataExcel } from '../../context/DataExcel'\r\nimport * as FileSaver from \"file-saver\"\r\nimport * as XLSX from \"xlsx\"\r\nimport styles from \"./Piepag.module.css\"\r\n\r\nfunction Piepag() {\r\n\r\n    const { dataExcel } = useContext(DataExcel)\r\n    const fileType = 'xlsx';\r\n\r\n    const exportToExcel = async () => {\r\n        const ws = XLSX.utils.json_to_sheet(dataExcel);\r\n        const wb = { Sheets: { data: ws }, SheetNames: ['data'] };\r\n        const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });\r\n        const data = new Blob([excelBuffer], { type: fileType });\r\n        FileSaver.saveAs(data, \"myfile\" + \".xlsx\")\r\n    }\r\n    return (\r\n        <div className={styles.piepag}>\r\n            <button onClick={exportToExcel}>\r\n                <img src='./imagenes/excel.jpg' alt='Imagen excel'/>\r\n                DESCARGAR RESULTADOS\r\n            </button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Piepag"],"mappings":"kQAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,KAAQ,OAAO,CACzC,OAASC,SAAS,KAAQ,yBAAyB,CACnD,MAAO,GAAK,CAAAC,SAAS,KAAM,YAAY,CACvC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAC5B,MAAO,CAAAC,MAAM,KAAM,qBAAqB,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAExC,QAAS,CAAAC,MAAMA,CAAA,CAAG,CAEd,IAAAC,WAAA,CAAsBV,UAAU,CAACC,SAAS,CAAC,CAAnCU,SAAS,CAAAD,WAAA,CAATC,SAAS,CACjB,GAAM,CAAAC,QAAQ,CAAG,MAAM,CAEvB,GAAM,CAAAC,aAAa,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,EAAA,CAAAC,EAAA,CAAAC,WAAA,CAAAC,IAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SACZR,EAAE,CAAGhB,IAAI,CAACyB,KAAK,CAACC,aAAa,CAAClB,SAAS,CAAC,CACxCS,EAAE,CAAG,CAAEU,MAAM,CAAE,CAAER,IAAI,CAAEH,EAAG,CAAC,CAAEY,UAAU,CAAE,CAAC,MAAM,CAAE,CAAC,CACnDV,WAAW,CAAGlB,IAAI,CAAC6B,KAAK,CAACZ,EAAE,CAAE,CAAEa,QAAQ,CAAE,MAAM,CAAEC,IAAI,CAAE,OAAQ,CAAC,CAAC,CACjEZ,IAAI,CAAG,GAAI,CAAAa,IAAI,CAAC,CAACd,WAAW,CAAC,CAAE,CAAEa,IAAI,CAAEtB,QAAS,CAAC,CAAC,CACxDV,SAAS,CAACkC,MAAM,CAACd,IAAI,CAAE,QAAQ,CAAG,OAAO,CAAC,yBAAAG,QAAA,CAAAY,IAAA,MAAAnB,OAAA,GAC7C,kBANK,CAAAL,aAAaA,CAAA,SAAAC,IAAA,CAAAwB,KAAA,MAAAC,SAAA,OAMlB,CACD,mBACIjC,IAAA,QAAKkC,SAAS,CAAEpC,MAAM,CAACqC,MAAO,CAAAC,QAAA,cAC1BlC,KAAA,WAAQmC,OAAO,CAAE9B,aAAc,CAAA6B,QAAA,eAC3BpC,IAAA,QAAKsC,GAAG,CAAC,sBAAsB,CAACC,GAAG,CAAC,cAAc,CAAC,CAAC,uBAExD,EAAQ,CAAC,CACR,CAAC,CAEd,CAEA,cAAe,CAAApC,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}